# Android开发教程之调试篇

## 1.解决语法错误

语法错误是开发者调试过程中的第一个要解决的问题。显然，不解决语法错误连程序编译都无法通过，更不可能运行了。而语法错误的问题的解决最重要的就是发现问题，只要发现语法错误，我们都可以按照语法来快速修复错误。

对于Android开发者，IDE(集成编译环境)几乎是必不可少的工具(对于可以不用IDE做Android开发的大佬，本教程可以无视)。我开发过程中用过的IDE有：AIDE(移动端)、eclipse(ADT)、Android Studio。所以针对这三种IDE简单做一下对比。

首先是Java语法的检查，这三种IDE都可以轻松的检查到核心层代码的错误并提供自动修复。不过移动端的AIDE的自动修复功能确实不如其他两种编译器，但是作为移动端的IDE其功能已经足够强大了。

语法错误主要还是要靠开发者自己解决，IDE发现问题并准确定位问题的能力才是第一位的。

Android的开发并不只是Java核心层开发，manifest清单，layout等设计都是用XML实现的。这里出现的XML结构问题上几种编译器也都能检查到，但是差异体现在资源的检索上。AIDE和eclipse几乎没有什么资源检索能力，使用了不存在的资源也不会给出错误，只有在编译后才会得到编译错误的信息。Android Studio在这里有着强大的优势，不但在引用不存在的资源时报错，在使用资源时还会给出自动补全列表，可以轻松的解决问题。

## 2.调试环境

对于编译成功的Android程序就需要跑起来才能进一步调试了。我们的开发一般都是在PC上，但是PC显然不能安装运行Android程序，解决方案有2个，各有利弊。

### 虚拟机调试

虚拟机调试是指在开发环境下运行一个Android虚拟机，并在这个虚拟机环境下安装运行我们开发的程序。

#### 优点

>  
* 首先是虚拟机调试非常方便的，不需要额外去找一部Android手机就可以开始调试程序了
* 其次是虚拟机可以轻易模拟各种尺寸各种SDK的Android环境

#### 缺点

> 
* 缺少大部分硬件支持，对于有用到传感器等硬件的程序没法调试
* 即使虚拟机调试完全正常，在真机上也可能出现奇怪的问题
* 对开发环境要求较高

### 真机调试

真机调试就是使用一台开启了USB调试的Android手机进行应用程序的直接运行调试。

#### 优点

>  
* 可以更真实的反映程序的运行状态
* 更有操作感

#### 缺点

> 
* 连接不方便
* 难以找到各种机型来测试

综合来说，我们

## 3.神器——logcat

logcat是Android的一个命令行工具，用于得到程序的log信息。在调试过程中，logcat是我们寻找逻辑错误的必备工具之一。上述三种IDE都提供了可视化的logcat工具，借助这个工具，我们可以把需要的信息过滤出来，了解程序的运行状况，便于发现逻辑错误。

通过导入`android.util.Log`并使用`Log.?("tag","msg")`等方法可以输出信息到logcat。

其中log信息分为5级：
> 
* v(VERBOSE)
* d(DEBUG)
* i(INFO)
* w(WARN)
* e(ERROR)

将上面的`?`替换为这5级之一(一个小写字母)就可以输出相应级别的log信息了。

在开发调试中我们可以使用各级log，但是最后发布的版本最好不要有低于i级的log信息出现。而log的信息不仅用在我们开发调试中，且对于发布后的程序的bug报告与检查修复有着极大的帮助，所以log分级一定要慎重。

实际上，程序开始运行时，logcat会收到大量的log信息，而这其中大多数信息跟我们的程序无关，或者是我们不关心的，所以logcat有着很好的过滤机制。我们可以根据级别过滤，根据tag标签过滤。这足以使我们快速精确定位到我们想查看的log信息。

在调试过程中我们通过logcat输出可能出现问题的变量，来检查变量是否与预想中不同，来寻找逻辑错误的源头。

我们也可以通过输出一些标记或者信息，判断代码的执行顺序是否与预想一致，来定位逻辑错误的位置。

程序崩溃时会输出tag为"AndroidRuntime"级别为e的错误信息，这些信息包含引起崩溃的代码的定位。

## 4.终极大招——Debug

Debug算是调试过程中的终极大招了，它真的十分强大有效。如果我们通过前面的一些方法仍然不能找到错误的原因，那么使用debug。如果使用debug也未能找到问题，那你可能需要请教其他人了。

前面说的三种IDE也都有debug工具(其中AIDE的早期版本是没有这个功能的)。

通过在代码里设置断点，debug启动程序，一旦执行到断点处的代码，程序就会暂停下来。

暂停中的程序可以执行下面的操作：

> 
* 新增或删除断点
* 执行一步(执行下一步代码，不是光标所在的下一行)
* 跳出执行(运行直到当前在执行的函数返回)
* 继续执行(运行程序直到遇到下一个断点)
* 查看变量(可以查看光标所在类的所有变量及其值)
* 使用命令行调用函数

这几个功能都是常用的，尤其是最后两个，是我们定位错误与明确错误原因的重要途径。合理使用这些功能可以让你找到基本所有逻辑错误，如果你能力足够，见多识广的话。

## 一些补充

当然调试的目的是解决错误、修复bug，前面的内容都是偏重找到问题的，并未多讲解决问题的方法，这就需要大家提高个人能力，当然，我认为找到问题才是最重要的。如果我们找到了问题，即使我们能力差点，通过互联网我们很容易找到解决方法，这样我们就能更好的提高了。

另外，实在抱歉，时间缘故未能在教程中举出实际的例子，大家看枯燥的教程可能收获有限，有其他问题欢迎继续与我交流。

同样恳请各路大神指正其中的问题，其中给大家带来的疑惑实在抱歉，还望海涵。

最后，我仍希望这篇教程多少能给大家一些帮助。